unit_tests:
  - name: unit_test__multiple_givens
    model: customers
    description: a unit test for explorer so we can see what multiple given blocks looks like
    given:
      - input: ref('stg_tpcds_core__customer')
        rows:
          - {
              current_address_sk: 1,
              customer_demographics_sk: 1,
              household_demographics_sk: 1,
              salutation: "Dr.",
            }
      - input: ref('stg_tpcds_core__customer_demographics')
        rows:
          - {
              customer_demographics_sk: 1,
              gender: "M",
              marital_status: "S",
              credit_rating: "Good",
            }
      - input: ref('stg_tpcds_core__customer_address')
        rows:
          - {
              customer_address_sk: 1,
              city: "Test City",
              state: "CA",
              country: "US",
            }
      - input: ref('stg_tpcds_core__household_demographics')
        rows:
          - {
              household_demographics_sk: 1,
              income_band_sk: 1,
              vehicle_count: 2,
            }
      - input: ref('stg_tpcds_core__income_band')
        rows:
          - {
              income_band_sk: 1,
              income_band_lower_bound: 0,
              income_band_upper_bound: 50000,
            }
    expect:
      rows:
        - { salutation: "Dr." }
